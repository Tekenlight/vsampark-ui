<div [@routerTransition]>
  <app-page-header [heading]="'List of Users'" [icon]="'fa-table'"></app-page-header>
   <p-table #datatable [value]="users" [paginator]="true" [rows]="10"   [lazy]="true" 
            (onLazyLoad)="fetchPageWise($event)" (onPage)="paginate($event)" [responsive]="true" [totalRecords]="totalRecords">
            <!-- <ng-template pTemplate="caption">
                <div style="text-align: right">
                    <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                    <input type="text" pInputText size="25" placeholder="Global Search" (input)="datatable.filterGlobal($event.target.value, 'contains')"
                        style="width:auto">
                </div>
            </ng-template> -->
            <ng-template pTemplate="header">
                <tr> 
                  <!-- <th>SL No</th> -->
                    <th *ngFor="let col of cols" [pSortableColumn]="col.field">
                       {{col.header}}
                    </th>
                    <th class="actions">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-user let-i="rowIndex">
                    <tr>
                        <!-- <td>{{i+1}}</td> -->
                        <td *ngFor="let col of cols;">
                            <!-- <div *ngIf="col.field == 'registered_address' then nested_object_content else normal_content" ></div>  -->
                            <!--nested object-->
                                
                                <!-- <ng-template #normal_content> -->
                                    {{user[col.field]}} 
                                <!-- </ng-template> -->
                        </td>
                         <td>   
                               &nbsp;  &nbsp;
                              <!-- <i class="fa fa-eye" style="font-size:30px;color:#888;cursor: pointer"(click)="viewUser(users[i])" ></i>  &nbsp;  &nbsp; -->
                              <i class="fa fa-edit" style="font-size:30px;color:#007ad9;cursor: pointer;"(click)="editUser(user,i)" ></i>
                               &nbsp;  &nbsp;
                              <i class="fa fa-trash" style="font-size:30px;color:rgb(196, 55, 55);cursor: pointer"(click)="disableUser(users[i])" ></i>
                              &nbsp;  &nbsp;
                              <i class="fa fa-link" style="font-size:30px;color:rgb(31, 23, 68);cursor: pointer" (click)="show_typeahead_box(user,i)" ></i>
                              
                              <div *ngIf="show_typeahead && i== row_selected"> <!--i==row_selected check : Else typeahead displays for all rows!!-->
                                    <br>
                                    <form [formGroup]="form">
                                        <label>Company Name</label>
                                        <input id="typeahead-format" type="text" class="form-control" 
                                            formControlName="company_name" [ngbTypeahead]="company_search" 
                                            [resultFormatter]="company_formatter" [inputFormatter]="company_formatter" /> 
                                       <br>
                                       <button type="button" [disabled]="form.pristine || form.invalid"  class="btn btn-primary" (click)="save()">Link</button>
                                       <br>
                                       <div *ngIf="duplicate_entry_error" class="alert alert-danger pt-3 mt-3">
                                            <b> {{duplicate_entry_error_message}}</b>
                                        </div>
                                        <div *ngIf="company_not_in_db" class="alert alert-danger pt-3 mt-3">
                                            <b> {{company_name_not_in_db_error_message}}</b>
                                         </div>

                                    </form>
                              </div>
                            </td>
                    </tr>
             </ng-template>
    </p-table>
</div>
<!-- <company-linkage-dialog [display]="display" (displayChange)="on_dialog_close($event)"></company-linkage-dialog> -->